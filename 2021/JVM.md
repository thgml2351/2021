# 자바 소스 파일(.java)을 JVM으로 실행하는 과정 이해하기

(1) JVM이란 무엇인가<br>
(2) 컴파일 하는 방법<br>
(3) 실행하는 방법<br>
(4) 바이트코드란 무엇인가<br>
(5) JIT 컴파일러란 무엇이며 어떻게 동작하는지<br>
(6) JVM 구성 요소<br>
(7) JDK와 JRE의 차이
<br><br><br>

## JVM(자바 가상 머신)

자바 바이트 코드를 실행시키기 위한 가상의 기계
자바로 작성된 모든 프로그램은 자바 가상 머신에서만 실행될 수 있다.

> ![JVM](https://user-images.githubusercontent.com/66400531/115671407-6f680d00-a385-11eb-83c6-edd39ed4df4e.PNG)
> 위의 그림처럼 서로 다른 운영체제라도 JVM만 설치되어 있다면, 같은 자바 프로그램이 아무런 추가 조치 없이 동작할 수 있다. 따라서 모든 운영체제에서 같이 사용할 수 있는 장점이 있다.

> 자바 프로그램과는 달리 JVM은 운영체제에 종속적이므로, 각 운영체제에 JVM을 설치해야 한다.<br> 또한, 자바 프로그램은 일반 프로그램보다 JVM이라는 한 단계를 거쳐야 하므로, 상대적으로 실행 속도가 느리다는 단점이 있다.

<br>

> 자바 클래스 파일 (.java)
> ↓
> 자바 컴파일러 : 자바 소스 코드를 JVM이 이해할 수 있는 자바 바이트 코드로 변환한다.
> ↓
> 자바 바이트 코드 (.class) : JVM이 이해할 수 있는 언어로 변환된 자바 소스 코드

<br><br>

## 컴파일 하는 방법

컴파일 할 소스를 우클릭 후 properties 클릭

location에서 어디에 저장되어 있는지 확인

D:\han\project\src\test.java
D:\han\project\src\ : 경로
test.java : 패키지명

cmd 커맨드 창에 해당 드라이브 명:을 입력한다.<br>
![1](https://user-images.githubusercontent.com/66400531/115671213-3cbe1480-a385-11eb-8fb8-599cca6f49a2.PNG)

그 후 cd + 해당 폴더까지 접근<br>
![2](https://user-images.githubusercontent.com/66400531/115671370-66773b80-a385-11eb-8d64-e9f96e8d6594.PNG)

javac + 패키지명 + 컴파일할 java파일 입력<br>
![3](https://user-images.githubusercontent.com/66400531/115671376-6840ff00-a385-11eb-98f3-c5f378340f6e.PNG)

아무런 메시지가 출력되지 않았으면 컴파일 성공

<br><br>

## 실행하는 방법

java + java파일 입력<br>
![4](https://user-images.githubusercontent.com/66400531/115671391-6b3bef80-a385-11eb-8c4a-e50dba26b12a.PNG)

<br><br>

## JAVAC 옵션

javac는 자바 컴파일러이며 소스파일(.java)을 바이트코드(.class)로 변환시켜주는 명령어이다.

사용법 : javac [option] [소스파일.java]

[option 종류]

1. classpath : 컴파일 시 필요로 하는 참조할 클래스 파일의 파일 경로를 지정

   > javac -classpath(cp) [참조파일 경로][소스파일.java]

2. d : 클래스 파일을 생성할 루트 디렉토리 설정

   > java -d [루트 디렉토리][소스파일.java]

3. encoding : 소스 파일에 사용된 문자열 설정

   > java -encoding [인코딩셋][소스파일.java]

4. g : 디버깅 정보 옵션

   > java -g:none : 디버깅 정보를 생성하지 않음
   > java -g:line(라인정보), var(지역변수), source(소스 파일 정보)

5. nowarn : 경고 메시지를 생성시키지 않는다.<br><br>

6. varbose : 컴파일러와 링커가 현재 어느 소스파일이 컴파일 되고 있고, 어느 파일이 링크되고 있는지 그 정보를 출력한다.<br><br>

7. sourcepath: 소스파일의 위치를 지정

여러 옵션을 동시에 사용하고 싶다면 소스파일 입력 전에 여러개를 입력하면 된다.

> ex) javac -cp -encoding -d [소스파일.java]

<br><br>

## 바이트코드란 무엇인가

> 자바 바이트 코드란 JVM이 이해할 수 있는 언어로 변환된 자바 소스 코드를 의미한다.<br>자바 컴파일러에 의해 변환되는 코드의 명령어 크기가 1바이트라서 자바 바이트 코드라고 불린다.<br>이러한 자바 바이트 코드의 확장자는 .class이다.<br>자바 바이트 코드는 JVM만 설치되어 있으면, 어떤 운영체제에서라도 실행될 수 있다.
> <br><br>

## JIT 컴파일러란 무엇이며 어떻게 동작하는지

> 반복되는 코드를 기계어 코드로 변환한다.<br>해당 코드 문구가 다시 발생하면 인터프리터는 해당 코드 문구를 기계어 코드로 변역하지 않고 대신 JIT에 의해 번역 된 기계어 코드로 변환한다<br>컴파일러가 실행된다.

<br><br>

## JVM 구성 요소

1. 인터프리터<br>
   자바 컴파일러에 의해 변환된 자바 바이트 코드를 읽고 해석하는 역할

> <b>컴파일과 인터프리터 비교</b><br>컴파일은 한 언어에서 다른 언어로 변역하는 프로그램이다.<br>[장점]<br>바이너리를 실행시키는 것이기 때문에 실행속도가 인터프리터에 비해 빠르다.<br>[단점]<br>컴퓨터 마다 컴파일을 해 줘야 한다. 즉, 운영체제에 맞게 호환되는 빌드환경을 구분해서 구축해야 한다.<br><br>인터프리터는 번역해야 할 파일을 받아 한 줄씩 실행한다.<br>[장점]<br>인터프리터만 설치되어 있으면 같은 프로그램 (스크립트)을 다른 컴퓨터에서도 실행시킬 수 있다.<br>[단점]<br>각 행마다 번역 및 실행을 거쳐야 한다. 따라서, 컴파일된 프로그램에 비해 속도가 느리다.

2. 클래스 로더<br>
   컴파일러가 SSD 내부에 만든 .class 파일을 읽는다. 이러한 행위를 말한다.
   SSD : 반도체 메모리에 데이터를 기록하는 저장 장치입니다

3. 실행엔진<br>
   클래스 로더에 존재하는 클래스를 읽으면서 static이 붙어 있는지 없는지 판단합니다.
   만약 static이 붙은 클래스가 없다면 자바는 그대로 종료됩니다.

4. 가비지컬렉터<br>
   사용하지 않는 메모리를 자동으로 회수한다.

<br><br>

## JDK와 JRE의 차이

> JRE : JVM이 자바프로그램을 실행시킬 때 반드시 필요한 라이브러리 및 기타 필수 파일을 가지고 있다. 자바 프로그램 개발이 아닌 단순 실행만 하려면 JRE만 설치해도 된다.<br> JDK : JRE 외에 개발을 위해 필요한 도구를 가지고 있다.

![5](https://user-images.githubusercontent.com/66400531/115671402-6d9e4980-a385-11eb-90d4-783dbdd952a4.PNG)
